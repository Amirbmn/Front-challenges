<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Weather Now ‚Äî Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
  @font-face {
    font-family: 'title-font';
    src: url(assets/fonts/Bricolage_Grotesque/BricolageGrotesque-VariableFont_opsz\,wdth\,wght.ttf);
  }
:root{
  --page-bg: #f2f5fb;
  --app-bg: #070826;
  --panel: #0f1530;
  --card: #0c1228;
  --muted: #97a0c9;
  --accent1: #5662f2;
  --accent2: #3c49d6;
  --glass: rgba(255,255,255,0.03);
  --soft-shadow: 0 30px 50px rgba(6,10,30,0.45);
  --radius-lg: 16px;
  --radius-md: 12px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg,#eef2fb 0%, #f6f8ff 100%);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:30px;
}

.app {
  width: 1020px;
  background: var(--app-bg);
  border-radius: 18px;
  padding: 36px;
  box-shadow: var(--soft-shadow);
  color: #e9eefc;
  margin-top: -150px;
}
.top {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}
.logo {
  display:flex;
  align-items:center;
  gap:12px;
  font-weight:700;
  font-size:18px;
}
.logo-image {
  position: absolute;
  margin-top: -780px;
  left: 440px;
  width: 120px;
  right: 100px;
  
  height: auto;

}
.units {
  background-color: rgba(255,255,255,0.05);
  color: var(--muted);
  font-weight: 600;
  font-size: 13px;
  border-radius: 10px;
  padding: 8px 14px;
  cursor: pointer;
  position: absolute;
  right: 420px;
  top: 30px;
  backdrop-filter: blur(8px);
  user-select: none;
  width: 80px;
  padding-left: 30px;
}

.units:hover {
  color: #fff;
}

.units-panel {
  display: none;
  position: absolute;
  top: 70px;
  right: 450px;
  background: rgba(15, 21, 48, 0.95);
  border: none;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.4);
  padding: 12px 0;
  min-width: 200px;
  z-index: 10;
}

.units-panel.active {
  display: block;
}

.units-panel .section-title {
  font-size: 12px;
  color: #97a0c9;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 8px 14px 4px;
}

.units-panel .option {
  padding: 8px 14px;
  color: #e9eefc;
  cursor: pointer;
  font-size: 13px;
  transition: background 0.2s;
   position: relative;
  padding-right: 24px; 

}

.units-panel .option:hover {
  background: rgba(255,255,255,0.08);
  color: #fff;
}


.units-panel .option::after {
  content: "‚úì";
  position: absolute;
  right: 10px;  /* stick it to the end */
  top: 50%;
  transform: translateY(-50%);
  opacity: 0;
  transition: opacity 0.2s;
 
}

.units-panel .option.selected::after {
  opacity: 1;
}



.icon-units{
  z-index: 100;
   background:var(--glass);
  padding:8px 12px;
  border-radius:10px;
  color:var(--muted);
  font-weight:600;
  font-size:13px;
  position: absolute;
right: 465px;
top: 30px;
background-color: rgba(255, 255, 255, 0);
}



.title {
  text-align:center;
  font-size:40px;
  margin:18px 0 16px;
  font-weight:700;
  color:#ffffff;
  letter-spacing: -0.2px;
 font-family: 'title-font';
 margin-top: 150px;
 margin-bottom: 50px;
}
.search-wrap {
  display:flex;
  justify-content:center;
  gap:12px;
  margin-bottom:26px;
}
.search {
  width:560px;
  display:flex;
  gap:8px;
}
.search input{
  flex:1;
  background-color: rgba(128, 128, 128, 0.324);
  border: none;
  padding:12px 14px;
  border-radius:10px;
 color:rgba(255, 255, 255, 0.7);
  outline:none;
  font-size:15px;
padding-left: 45px;
}
input[type="search"]::placeholder {
  color:rgba(255, 255, 255, 0.7);
margin-left: 200px;
font-size: 15px;

}


.search-logo{
  position: relative;
  left: 45px;
  width: 16px;
}

.search button{
  background: linear-gradient(180deg,var(--accent1),var(--accent2));
  border:none;
  color:white;
  padding:10px 16px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}
.layout {
  display:grid;
  grid-template-columns: 1fr 320px;
  gap:26px;
  align-items:start;
}
.left {
  display:flex;
  flex-direction:column;
  gap:14px;
}
.main-card {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 22px;
  border-radius: 14px;
  height: 190px;
 background: url(assets/images/bg-today-large.svg);
  position:relative;
  overflow:visible;
}
.main-left {
  display:flex;
  flex-direction:column;
  gap:6px;
  align-self:flex-start;
  margin-top: 30px;
  margin-left: 5px;
}
.location {
  font-size:18px;
  font-weight:700;
  color:#ffffff;
  margin-bottom:2px;
}
.date {
  font-size:13px;
  color: rgba(255,255,255,0.9);
}
.main-right {
  display:flex;
  align-items:center;
  gap:18px;
}
.temp {
  font-size:56px;
  font-weight:700;
  line-height:1;
}
.main-sun {
  width:100px;
  height:100px;

  background: rgba(255, 204, 80, 0.12);
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 8px 26px rgba(74,78,219,0.18);
  background-color: rgba(255, 255, 255, 0);
}



.main-sun img{ width:68px; height:68px;  }
.stats {
  display:flex;
  gap:12px;
  margin-top:4px;
 
}
.stat {
  background: var(--card);
  border-radius:12px;
  padding:14px 16px;
  flex:1;
  height:75px;
  min-width:0;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
  background-color: rgba(128, 128, 128, 0.324);
  margin-bottom: 20px;
}


.stat.loading{
  background: var(--card);
  border-radius:12px;
  padding:14px 16px;
  flex:1;
  height:75px;
  min-width:0;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
  background-color: rgba(128, 128, 128, 0.324);
  margin-bottom: 20px;
}


.stat .label { font-size:13px; color:var(--muted); margin-bottom:6px; }
.stat .value { font-size:18px; font-weight:700; color:#fff;margin-top: 10px; }
.daily-area {
  margin-top:6px;
}
.daily-title {
  font-size:14px;
  color:#cfe0ff;
  font-weight:600;
  margin-bottom:20px;
}
 
select {
  background-color: rgba(221, 218, 218, 0.229);
  color: rgba(255, 255, 255, 0.833);
  padding: 5px 10px;
  width: 90px; 
  border-radius: 8px;
  border: none;
  outline: none;
}


select:focus {
  width: 220px;
}


select:after{
  width: 90px;
}

.select-day{
  background-color: rgb(118, 116, 116);
  border: none;

}

.day-select {
  background-color: rgba(255, 255, 255, 0.05);
  color: var(--muted);
  font-weight: 600;
  font-size: 13px;
  border-radius: 10px;
  padding: 8px 14px;
  cursor: pointer;
  position: relative;
  display: inline-block;
  backdrop-filter: blur(8px);
  user-select: none;
  width: 100px;
  
}


.selected-day{
  margin-top: 5px;
  margin-bottom: 5px;
}

.day-select:hover {
  color: #fff;
}

.day-select .arrow-down {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 10px;
}

.day-panel {
  display: none;
  position: absolute;
  top: 35px; /* Adjust according to where you want it */
  right: 0;
  background: rgba(15, 21, 48, 0.95);
  border: none;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
  padding: 12px 0;
  min-width: 200px;
  z-index: 10;
}

.day-panel.active {
  display: block;
}

.day-panel .option {
  padding: 8px 14px;
  color: #e9eefc;
  cursor: pointer;
  font-size: 13px;
  transition: background 0.2s;
}

.day-panel .option:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #fff;
}


.day-panel {
  display: none;
  position: absolute;
  top: 130px; /* Adjust accordingly */
  right: 450px;
  background: rgba(15, 21, 48, 0.95);
  border: none;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.4);
  padding: 12px 0;
  min-width: 200px;
  z-index: 10;
}

.day-panel.active {
  display: block;
}

.day-panel .option {
  padding: 8px 14px;
  color: #e9eefc;
  cursor: pointer;
  font-size: 13px;
  transition: background 0.2s;
}

.day-panel .option:hover {
  background: rgba(255,255,255,0.08);
  color: #fff;
}



.day{
  background-color: rgba(15, 21, 48, 0.95);
border: none;
 width: 200px;
}

.day2{
padding-right: 200px;
 background-color: rgba(15, 21, 48, 0.95);
 width: 400px;
}

.daily-row {
  display:flex;
  gap:10px;
  overflow-x:auto;
  padding-bottom:6px;
}
.daily-row::-webkit-scrollbar{ height:8px }
.daily-row::-webkit-scrollbar-thumb{ background: rgba(128, 128, 128, 0.324);; border-radius:6px }
.day-card {
  height: 123px;
  min-width:72px;
  background: var(--card);
  border-radius:12px;
  padding:10px 8px;
  text-align:center;
  flex-shrink:0;
  background-color: rgba(128, 128, 128, 0.324);
  box-shadow: 0 10px 30px rgba(2,6,23,0.35);
}
.day-card .dow{ font-size:13px; color:var(--muted); margin-bottom:15px; }
.day-card .icon img{ width:35px; height:35px; display:block; margin-bottom: 18px;margin-left: 15px;}
.day-card .range{ font-size:13px; color:#e6f0ff; }
.hourly-panel {
  background: linear-gradient(180deg,  rgba(128, 128, 128, 0.324),  rgba(128, 128, 128, 0.324));
  border-radius: 14px;
  padding:14px;
  scrollbar-width: thin;
  width: 350px;
}
.hourly-head {
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:var(--muted);
  font-weight:700;
  margin-bottom:8px;
}

.hourly-list{
  display:flex;
  flex-direction:column;
  gap:10px;
  max-height:420px;
  overflow:auto;
  padding-right:6px;
  overflow-y: scroll;
  scrollbar-width: thin;
  scrollbar-color: rgba(128, 128, 128, 0.324) transparent ;
}
.hour {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:12px;
  border-radius:12px;
  background-color: rgba(128, 128, 128, 0.171);
  border: 1px solid rgba(255,255,255,0.02);
}
.hour .time { color:var(--muted); width:64px; font-weight:700;margin-right: 108px; color:#eaf0ff;}
.hour .mid { display:flex; align-items:center; gap:8px; color:#eaf0ff; font-size:14px; height: 15px;}
.hour .mid img{ width:35px; height:35px; display:block }
.hour .temp-h{ font-weight:700; color:#fff; width:36px; text-align:right }
@media (max-width:1100px){
  .app{ width:94% }
  .title{ font-size:32px }
}
@media (max-width:880px){
  .layout{ grid-template-columns: 1fr; }
  .hourly-panel{ order:2 }
}





option{
  background-color: rgba(15, 21, 48, 0.95);
  border:none;
  height: 10px;
}



    .suggestions {
      position: absolute;
      top: 250px;
      left: 650px;
      width: 450px;
      background: rgba(20, 26, 60, 0.95);
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      max-height: 200px;
      overflow-y: auto;
      z-index: 20;
    }

    .suggestion {
      padding: 10px 12px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .suggestion:hover, .suggestion.selected {
      background: rgba(255,255,255,0.12);
    }


.main-card.loading {
  background: url(assets/images/icon-loading.svg) center center no-repeat;
  background-size: 60px;
     background-color: rgba(255,255,255,0.12);
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 22px;
  border-radius: 14px;
  height: 190px;
  position:relative;
  overflow:visible;
}


.main-card.loading::after {
  content: "Loading";
  position: absolute;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  color: #aab4e0;
  font-size: 15px;
  font-weight: 500;
  text-align: center;
  letter-spacing: 0.3px;
}



</style>
</head>
<body>
  <img class="logo-image" src="assets/images/logo.svg" alt="logo">
  <img class="icon-units" src="assets/images/icon-units.svg" alt="">
 <div class="units" id="units-trigger">Units</div>

<div class="units-panel" id="units-panel">
  <div class="option">Switch to imperial</div>
  <div class="section-title">Temperature</div>
  <div class="option" data-value="celsius">Celsius (¬∞C)</div>
  <div class="option" data-value="fahrenheit">Fahrenheit (¬∞F)</div>
   <div style="color: rgba(128, 128, 128, 0.213);">&nbsp;&nbsp;&nbsp;_________________________&nbsp;&nbsp;&nbsp;</div>
  <div class="section-title">Wind Speed</div>
  <div class="option" data-value="kmh">km/h</div>
  <div class="option" data-value="mph">mph</div>
    <div style="color: rgba(128, 128, 128, 0.213);">&nbsp;&nbsp;&nbsp;_________________________&nbsp;&nbsp;&nbsp;</div>
  <div class="section-title">Precipitation</div>
  <div class="option" data-value="mm">Millimeters (mm)</div>
  <div class="option" data-value="inches">Inches (in)</div>
</div>

  <div class="app">
    <div class="top">
      <div class="logo"></div>
      
    </div>
    <h1 class="title">How's the sky looking today?</h1>
    
    <div class="search-wrap">
      <div class="search">
        <img class="search-logo" src="assets/images/icon-search.svg" alt="">
        <input id="city" type="search" placeholder="Search for a place..." aria-label="Search for a place">
        
<div id="suggestions" class="suggestions"></div>
        <button id="search-btn" onclick="getWeather()">Search</button>
      </div>
    </div>
    <div class="layout">
      <div class="left">
        <div class="main-card">
          <div class="main-left">
            
            <div class="location">Berlin, Germany</div>
            <div class="date">Tuesday, Aug 5, 2025</div>
          </div>
          <div class="main-right">
            <div class="main-sun">
              <img class="main-sun" src="assets/images/icon-sunny.webp" alt="">
            </div>
            <div class="temp">20¬∞</div>
          
          </div>
        </div>
        <div class="stats">
          <div class="stat">
            <div class="label">Feels Like</div>
            <div class="value">18¬∞</div>
          </div>
          <div class="stat">
            <div class="label">Humidity</div>
            <div class="value">46%</div>
          </div>
          <div class="stat">
            <div class="label">Wind</div>
            <div class="value">14 km/h</div>
          </div>
          <div class="stat">
            <div class="label">Precipitation</div>
            <div class="value">0 mm</div>
          </div>
        </div>
        <div class="daily-area">
          <div class="daily-title">Daily forecast</div>
          <div class="daily-row" aria-label="Daily forecast">
            <div class="day-card">
              <div class="dow">Tue</div>
              <div class="icon"><img src="assets/images/icon-rain.webp" alt="rain"></div>
              <div class="range">20¬∞ <span style="opacity:.65">/ 14¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Wed</div>
              <div class="icon"><img src="assets/images/icon-rain.webp" alt="rain"></div>
              <div class="range">21¬∞ <span style="opacity:.65">/ 15¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Thu</div>
              <div class="icon"><img src="assets/images/icon-sunny.webp" alt="sun"></div>
              <div class="range">24¬∞ <span style="opacity:.65">/ 14¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Fri</div>
              <div class="icon"><img src="assets/images/icon-partly-cloudy.webp" alt="partly"></div>
              <div class="range">25¬∞ <span style="opacity:.65">/ 13¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Sat</div>
              <div class="icon"><img src="assets/images/icon-storm.webp" alt="storm"></div>
              <div class="range">21¬∞ <span style="opacity:.65">/ 15¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Sun</div>
              <div class="icon"><img src="assets/images/icon-partly-cloudy.webp" alt="cloud"></div>
              <div class="range">25¬∞ <span style="opacity:.65">/ 16¬∞</span></div>
            </div>
            <div class="day-card">
              <div class="dow">Mon</div>
              <div class="icon"><img src="assets/images/icon-fog.webp" alt="fog"></div>
              <div class="range">24¬∞ <span style="opacity:.65">/ 15¬∞</span></div>
            </div>
          </div>
        </div>
      </div>
      <aside class="hourly-panel" aria-label="Hourly forecast">
     <div class="hourly-head">
  <div>Hourly forecast</div>


  <div class="day-select" id="day-trigger">
    <p class="selected-day">Tuesday</p>
    <span class="arrow-down">‚ñº</span>
  </div>


  <div class="day-panel" id="day-panel">
    <div class="option" data-value="monday">Monday</div>
    <div class="option" data-value="tuesday">Tuesday</div>
    <div class="option" data-value="wednesday">Wednesday</div>
    <div class="option" data-value="thursday">Thursday</div>
    <div class="option" data-value="friday">Friday</div>
    <div class="option" data-value="saturday">Saturday</div>
    <div class="option" data-value="sunday">Sunday</div>
    
  </div>
</div>

        <div class="hourly-list">
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
            <div class="time">1 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
            <div class="time">2 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
            <div class="time">3 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-partly-cloudy.webp" alt=""><div></div></div>
              <div class="time">4 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
            
            <div class="mid"><img src="assets/images/icon-sunny.webp" alt=""><div></div></div>
           <div class="time">5 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
           
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
           <div class="time">6 PM</div>
            <div class="temp-h">19¬∞</div>
          </div>
          <div class="hour">
          
            <div class="mid"><img src="assets/images/icon-rain.webp" alt=""><div></div></div>
            <div class="time">7 PM</div>
            <div class="temp-h">18¬∞</div>
          </div>
          <div class="hour">
            
            <div class="mid"><img src="assets/images/icon-fog.webp" alt=""><div></div></div>
          <div class="time">8 PM</div>
            <div class="temp-h">18¬∞</div>
          </div>
          <div class="hour">
         
            <div class="mid"><img src="assets/images/icon-rain.webp" alt=""><div></div></div>
              <div class="time">9 PM</div>
            <div class="temp-h">17¬∞</div>
          </div>
          <div class="hour">
         
            <div class="mid"><img src="assets/images/icon-rain.webp" alt=""><div></div></div>
              <div class="time">10 PM</div>
            <div class="temp-h">17¬∞</div>
          </div>
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
            <div class="time">11 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
          <div class="hour">
            <div class="mid"><img src="assets/images/icon-overcast.webp" alt=""><div></div></div>
            <div class="time">12 PM</div>
            <div class="temp-h">20¬∞</div>
          </div>
        
        </div>
      </aside>
    </div>
  </div>






<script>
/* ---------------- UNIT MENU LOGIC ---------------- */
const unitsTrigger = document.getElementById('units-trigger');
const unitsPanel = document.getElementById('units-panel');
unitsTrigger.addEventListener('click', () => unitsPanel.classList.toggle('active'));
document.addEventListener('click', (e) => {
  if (!unitsTrigger.contains(e.target) && !unitsPanel.contains(e.target)) {
    unitsPanel.classList.remove('active');
  }
});
const unitGroups = [["celsius","fahrenheit"],["kmh","mph"],["mm","inches"]];
unitGroups.forEach(group => {
  group.forEach(value => {
    const option = document.querySelector(`.option[data-value="${value}"]`);
    if (option) {
      option.addEventListener("click", () => {
        group.forEach(v => {
          document.querySelector(`.option[data-value="${v}"]`).classList.remove("selected");
        });
        option.classList.add("selected");
      });
    }
  });
});

/* ---------------- DAY SELECT LOGIC ---------------- */
const dayTrigger = document.getElementById('day-trigger');
const dayPanel = document.getElementById('day-panel');
dayTrigger.addEventListener('click', () => dayPanel.classList.toggle('active'));

dayPanel.querySelectorAll('.option').forEach(opt => {
  opt.addEventListener('click', e => {
    const dayText = dayTrigger.querySelector('.selected-day'); // keep only the text part
    if (dayText) {
      dayText.textContent = e.target.textContent;
localStorage.setItem('selectedDay', e.target.textContent);

    }
    dayPanel.classList.remove('active');
    updateHourlyForDay(e.target.textContent);
  });
});


let globalHourly = null; // store full hourly dataset
let globalDaily = null;

/* ---------------- WEATHER LOGIC ---------------- */
async function getWeather() {
  const city = document.getElementById("city").value.trim();
  if (!city) return alert("Please enter a city name.");
showLoader();
  try {
    // 1Ô∏è‚É£ Get coordinates
    const geoRes = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(city)}`);
    const geoData = await geoRes.json();
    if (!geoData.length) throw new Error("City not found");
    const lat = geoData[0].lat;
    const lon = geoData[0].lon;
const locationName = geoData[0].display_name.split(","); 

const cityName = locationName[0];  
const countryName = locationName[locationName.length - 1]; 

    // 2Ô∏è‚É£ Get weather data
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,precipitation,wind_speed_10m&hourly=temperature_2m,precipitation,relative_humidity_2m,wind_speed_10m,weathercode&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto`;
    const res = await fetch(url);
    const data = await res.json();

    const current = data.current;
    globalHourly = data.hourly;
    globalDaily = data.daily;

    // --- Update main card ---
document.querySelector(".location").textContent = cityName+','+countryName;
const now = new Date();
document.querySelector(".date").textContent = now.toLocaleDateString("en-US", {
  weekday: "long", month: "short", day: "numeric", year: "numeric"
});
document.querySelector(".temp").textContent = `${Math.round(current.temperature_2m)}¬∞`;
document.querySelector(".stat:nth-child(1) .value").textContent = `${Math.round(current.apparent_temperature)}¬∞`;
document.querySelector(".stat:nth-child(2) .value").textContent = `${current.relative_humidity_2m}%`;
document.querySelector(".stat:nth-child(3) .value").textContent = `${Math.round(current.wind_speed_10m)} km/h`;
document.querySelector(".stat:nth-child(4) .value").textContent = `${current.precipitation ?? 0} mm`;
// pick weather icon based on weathercode
const code = current.weathercode ?? 0;
const iconFile = weatherIcons[code] || "icon-partly-cloudy.webp";
document.querySelector(".main-right img").src = `assets/images/${iconFile}`;


    // --- Update daily cards ---
    const dailyRow = document.querySelector(".daily-row");
    dailyRow.innerHTML = "";
    for (let i = 0; i < globalDaily.time.length; i++) {
      const dayName = new Date(globalDaily.time[i]).toLocaleDateString("en-US", { weekday: "short" });
      const max = Math.round(globalDaily.temperature_2m_max[i]);
      const min = Math.round(globalDaily.temperature_2m_min[i]);
      dailyRow.innerHTML += `
        <div class="day-card">
          <div class="dow">${dayName}</div>
          <div class="icon"><img src="assets/images/icon-sunny.webp" alt="icon"></div>
          <div class="range">${max}¬∞ <span style="opacity:.65">/ ${min}¬∞</span></div>
        </div>`;
    }

    // --- Default: show today's hourly ---
    const today = new Date(globalHourly.time[0]).toLocaleDateString("en-US", { weekday: "long" });
    updateHourlyForDay(today);

    hideLoader();
  } catch (err) {
    hideLoader();
    alert("Error: " + err.message);
    console.error(err);
  }
}

/* ---------------- HOURLY UPDATE ---------------- */
function updateHourlyForDay(dayName) {
  if (!globalHourly || !globalDaily) return;
  const hourlyList = document.querySelector(".hourly-list");
  hourlyList.innerHTML = "";

  const times = globalHourly.time;
  const temps = globalHourly.temperature_2m;

  // üß© Normalize requested day
  const targetDay = dayName.toLowerCase();

  // find all hours matching that day (or fallback to first day)
  let hasAny = false;

  for (let i = 0; i < times.length; i++) {
    const date = new Date(times[i]);
    const weekday = date.toLocaleDateString("en-US", { weekday: "long" }).toLowerCase();

    if (weekday === targetDay) {
      hasAny = true;
      const code = globalHourly.weathercode[i];
      const iconFile = weatherIcons[code] || "icon-partly-cloudy.webp";

      hourlyList.innerHTML += `
        <div class="hour">
          <div class="mid"><img src="assets/images/${iconFile}" alt="weather"></div>
          <div class="time">${formatTo12Hour(date)}</div>
          <div class="temp-h">${Math.round(temps[i])}¬∞</div>
        </div>`;
    }
  }

  // üîÅ if no hours found (like Monday missing), fallback to the first day
  if (!hasAny) {
    const fallbackDay = new Date(times[0]).toLocaleDateString("en-US", { weekday: "long" });
    updateHourlyForDay(fallbackDay);
  }
}




function formatTo12Hour(date) {
  return date.toLocaleTimeString([], {
    hour: 'numeric',
    hour12: true
  });
}


const weatherIcons = {
  0: "icon-sunny.webp",
  1: "icon-sunny.webp",
  2: "icon-partly-cloudy.webp",
  3: "icon-overcast.webp",
  45: "icon-fog.webp",
  48: "icon-fog.webp",
  51: "icon-rain.webp",
  53: "icon-rain.webp",
  55: "icon-rain.webp",
  61: "icon-rain.webp",
  63: "icon-rain.webp",
  65: "icon-rain.webp",
  71: "icon-snow.webp",
  73: "icon-snow.webp",
  75: "icon-snow.webp",
  80: "icon-rain.webp",
  81: "icon-rain.webp",
  82: "icon-rain.webp",
  95: "icon-storm.webp",
  99: "icon-storm.webp"
};



const cityInput = document.getElementById("city");
cityInput.addEventListener("keydown", function(e){
  if (e.key === 'Enter') {
   
    const city = cityInput.value.trim();
    if (city) {
       getWeather();   
      addCityToHistory(city);  
      renderSuggestions();     
             
    }
  }
});



cityInput.addEventListener("blur", () => {

  
    suggestionsBox.innerHTML = "";
  
});






function cToF(c) {
  return Math.round((c * 9/5) + 32);
}

function kmhToMph(kmh) {
  return Math.round(kmh / 1.609);
}

function mmToInches(mm) {
  return (mm / 25.4).toFixed(2);
}

const unitOptions = document.querySelectorAll('.units-panel .option[data-value]');
unitOptions.forEach(option => {
  option.addEventListener('click', () => {
    const selected = option.dataset.value;
    updateUnits(selected);
  });
});


function updateUnits(selectedUnit) {
const locEl = document.querySelector(".location");
const dateEl = document.querySelector(".date");
const tempEl = document.querySelector(".temp");
const feelsEl = document.querySelector(".stat:nth-child(1) .value");
const humidEl = document.querySelector(".stat:nth-child(2) .value");
const windEl = document.querySelector(".stat:nth-child(3) .value");
const precEl = document.querySelector(".stat:nth-child(4) .value");

if (locEl) locEl.textContent = `${cityName}, ${countryName}`;
if (dateEl) {
  const now = new Date();
  dateEl.textContent = now.toLocaleDateString("en-US", {
    weekday: "long", month: "short", day: "numeric", year: "numeric"
  });
}
if (tempEl) tempEl.textContent = `${Math.round(current.temperature_2m)}¬∞`;
if (feelsEl) feelsEl.textContent = `${Math.round(current.apparent_temperature)}¬∞`;
if (humidEl) humidEl.textContent = `${current.relative_humidity_2m}%`;
if (windEl) windEl.textContent = `${Math.round(current.wind_speed_10m)} km/h`;
if (precEl) precEl.textContent = `${current.precipitation ?? 0} mm`;

  
  const tempC = globalHourly ? Math.round(globalHourly.temperature_2m[0]) : 20;
  const feelsC = globalHourly ? Math.round(globalHourly.temperature_2m[0]) : 18;
  const windKmh = globalHourly ? Math.round(globalHourly.wind_speed_10m[0]) : 14;
  const precMm = globalHourly ? globalHourly.precipitation[0] : 0;

  const isF = document.querySelector('.option[data-value="fahrenheit"]').classList.contains('selected');
  const isMph = document.querySelector('.option[data-value="mph"]').classList.contains('selected');
  const isInches = document.querySelector('.option[data-value="inches"]').classList.contains('selected');

  
  tempEl.textContent = isF ? `${cToF(tempC)}¬∞` : `${tempC}¬∞`;
  feelsEl.textContent = isF ? `${cToF(feelsC)}¬∞` : `${feelsC}¬∞`;

  
  windEl.textContent = isMph ? `${kmhToMph(windKmh)} mph` : `${windKmh} km/h`;

  
  precEl.textContent = isInches ? `${mmToInches(precMm)} in` : `${precMm} mm`;

  
  const hourlyTemps = document.querySelectorAll('.hourly-list .temp-h');
  hourlyTemps.forEach((el, idx) => {
    const t = Math.round(globalHourly.temperature_2m[idx]);
    el.textContent = isF ? `${cToF(t)}¬∞` : `${t}¬∞`;
  });
}



   
    const searchBtn = document.getElementById("search-btn");
    const suggestionsBox = document.getElementById("suggestions");

    let searchHistory = [];
    let selectedIndex = -1;

    function renderSuggestions() {
      if (searchHistory.length === 0) {
        suggestionsBox.innerHTML = '';
        return;
      }
      suggestionsBox.innerHTML = searchHistory.map((city, index) => `
        <div class="suggestion ${index === selectedIndex ? 'selected' : ''}" data-index="${index}">
          ${city}
        </div>
      `).join('');
    }

    function addCityToHistory(city) {
      if (!city) return;
      if (!searchHistory.includes(city)) {
        searchHistory.unshift(city);
        if (searchHistory.length > 10) searchHistory.pop(); // Keep only last 10
      }
      renderSuggestions();
    }

    searchBtn.addEventListener("click", () => {
      const city = cityInput.value.trim();
      if (!city) return;
      addCityToHistory(city);
      suggestionsBox.innerHTML = '';
      selectedIndex = -1;
     
    });

    cityInput.addEventListener("focus", renderSuggestions);
function showSuggestions(query) {
  const filtered = searchHistory.filter(city =>
    city.toLowerCase().includes(query.toLowerCase())
  );

  if (filtered.length === 0) {
    suggestionsBox.innerHTML = '';
    return;
  }

  suggestionsBox.innerHTML = filtered
    .map((city, i) => `<div class="suggestion ${i === selectedIndex ? 'selected' : ''}">${city}</div>`)
    .join('');
}



    suggestionsBox.addEventListener("click", (e) => {
      if (e.target.classList.contains("suggestion")) {
        cityInput.value = e.target.textContent;
        suggestionsBox.innerHTML = '';
      getWeather();
      }
    });


suggestionsBox.addEventListener("mousedown", (e) => {
  const suggestion = e.target.closest(".suggestion");
  if (!suggestion) return;
  const city = suggestion.textContent.trim();
  cityInput.value = city;
  suggestionsBox.innerHTML = "";
getWeather();
});


function showLoader() {
  const mainCard = document.querySelector('.main-card');
  const stats = document.querySelectorAll('.stat .value');
  const dayCards=document.querySelectorAll('.day-card');
  const mids=document.querySelectorAll('.mid');
  const times=document.querySelectorAll('.time');
  const temps=document.querySelectorAll('.temp-h');
  const dayTrigger = document.getElementById('day-trigger');
  mainCard.classList.add('loading');

  // Hide main weather info
  mainCard.querySelector('.main-left .location').textContent = '';
  mainCard.querySelector('.main-left .date').textContent = '';
  mainCard.querySelector('.main-right .temp').textContent = '';
  mainCard.querySelector('.main-right img').src = '';
 
 

   if (dayTrigger) {
    const dayText = dayTrigger.querySelector('.selected-day'); // assume text is wrapped like <span class="day-text">Tuesday</span>
    if (dayText) {
      dayText.textContent = '__';
    }
  }


stats.forEach(s => s.textContent = '___');
dayCards.forEach(s => s.textContent = '');
mids.forEach(s => s.textContent = '');
times.forEach(s => s.textContent = '');
temps.forEach(s => s.textContent = '');
}


function hideLoader() {
  const mainCard = document.querySelector('.main-card');
  const dayTrigger = document.getElementById('day-trigger');
  const savedDay = localStorage.getItem('selectedDay'); // get saved day
  if (dayTrigger) {
    const dayText = dayTrigger.querySelector('.selected-day');
    if (dayText) {
      // use saved day if exists, otherwise default
      dayText.textContent = savedDay || 'Tuesday';
    }
  }
  mainCard.classList.remove('loading');
}






</script>




</body>
</html>